<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="프로세스 동기화배경생산자 소비자 문제에서 각 프로세스는 공유 메모리에 접근하므로 공통 변수와 버퍼를 공유한다. 이 때 공유 변수의 값이 결과에 영향을 주므로 각 프로세스에서의 수행이 병행적으로 이루어지면 실행되는 순서에 따라 올바르게 동작하지 않을 수 있다. 이처럼 병행으로 수행되는 여러 프로세스가 공통된 데이터를 조작할 때 결과가 접근 순서에 의해 결정되">
<meta property="og:type" content="article">
<meta property="og:title" content="운영체제 강의노트 정리 - 프로세스 동기화">
<meta property="og:url" content="http://presto95.github.io/2020/01/18/%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C-%EA%B0%95%EC%9D%98%EB%85%B8%ED%8A%B8-%EC%A0%95%EB%A6%AC-%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4-%EB%8F%99%EA%B8%B0%ED%99%94/index.html">
<meta property="og:site_name" content="Presto">
<meta property="og:description" content="프로세스 동기화배경생산자 소비자 문제에서 각 프로세스는 공유 메모리에 접근하므로 공통 변수와 버퍼를 공유한다. 이 때 공유 변수의 값이 결과에 영향을 주므로 각 프로세스에서의 수행이 병행적으로 이루어지면 실행되는 순서에 따라 올바르게 동작하지 않을 수 있다. 이처럼 병행으로 수행되는 여러 프로세스가 공통된 데이터를 조작할 때 결과가 접근 순서에 의해 결정되">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2020-01-17T15:22:49.000Z">
<meta property="article:modified_time" content="2020-01-17T15:23:24.784Z">
<meta property="article:author" content="Presto">
<meta property="article:tag" content="operating system">
<meta name="twitter:card" content="summary">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>운영체제 강의노트 정리 - 프로세스 동기화</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
      
<link rel="stylesheet" href="/css/rtl.css">

    
    <!-- rss -->
    
    
<meta name="generator" content="Hexo 4.2.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Posts</a></li>
         
          <li><a href="/tags/">Tag</a></li>
         
          <li><a href="/categories/">Category</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2020/01/18/%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C-%EA%B0%95%EC%9D%98%EB%85%B8%ED%8A%B8-%EC%A0%95%EB%A6%AC-%EA%B5%90%EC%B0%A9%EC%83%81%ED%83%9C/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2020/01/18/%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C-%EA%B0%95%EC%9D%98%EB%85%B8%ED%8A%B8-%EC%A0%95%EB%A6%AC-CPU-%EC%8A%A4%EC%BC%80%EC%A4%84%EB%A7%81/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://presto95.github.io/2020/01/18/%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C-%EA%B0%95%EC%9D%98%EB%85%B8%ED%8A%B8-%EC%A0%95%EB%A6%AC-%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4-%EB%8F%99%EA%B8%B0%ED%99%94/" target="_blank" rel="noopener"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://presto95.github.io/2020/01/18/%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C-%EA%B0%95%EC%9D%98%EB%85%B8%ED%8A%B8-%EC%A0%95%EB%A6%AC-%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4-%EB%8F%99%EA%B8%B0%ED%99%94/&text=운영체제 강의노트 정리 - 프로세스 동기화" target="_blank" rel="noopener"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://presto95.github.io/2020/01/18/%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C-%EA%B0%95%EC%9D%98%EB%85%B8%ED%8A%B8-%EC%A0%95%EB%A6%AC-%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4-%EB%8F%99%EA%B8%B0%ED%99%94/&title=운영체제 강의노트 정리 - 프로세스 동기화" target="_blank" rel="noopener"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://presto95.github.io/2020/01/18/%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C-%EA%B0%95%EC%9D%98%EB%85%B8%ED%8A%B8-%EC%A0%95%EB%A6%AC-%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4-%EB%8F%99%EA%B8%B0%ED%99%94/&is_video=false&description=운영체제 강의노트 정리 - 프로세스 동기화" target="_blank" rel="noopener"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=운영체제 강의노트 정리 - 프로세스 동기화&body=Check out this article: http://presto95.github.io/2020/01/18/%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C-%EA%B0%95%EC%9D%98%EB%85%B8%ED%8A%B8-%EC%A0%95%EB%A6%AC-%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4-%EB%8F%99%EA%B8%B0%ED%99%94/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://presto95.github.io/2020/01/18/%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C-%EA%B0%95%EC%9D%98%EB%85%B8%ED%8A%B8-%EC%A0%95%EB%A6%AC-%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4-%EB%8F%99%EA%B8%B0%ED%99%94/&title=운영체제 강의노트 정리 - 프로세스 동기화" target="_blank" rel="noopener"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://presto95.github.io/2020/01/18/%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C-%EA%B0%95%EC%9D%98%EB%85%B8%ED%8A%B8-%EC%A0%95%EB%A6%AC-%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4-%EB%8F%99%EA%B8%B0%ED%99%94/&title=운영체제 강의노트 정리 - 프로세스 동기화" target="_blank" rel="noopener"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://presto95.github.io/2020/01/18/%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C-%EA%B0%95%EC%9D%98%EB%85%B8%ED%8A%B8-%EC%A0%95%EB%A6%AC-%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4-%EB%8F%99%EA%B8%B0%ED%99%94/&title=운영체제 강의노트 정리 - 프로세스 동기화" target="_blank" rel="noopener"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://presto95.github.io/2020/01/18/%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C-%EA%B0%95%EC%9D%98%EB%85%B8%ED%8A%B8-%EC%A0%95%EB%A6%AC-%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4-%EB%8F%99%EA%B8%B0%ED%99%94/&title=운영체제 강의노트 정리 - 프로세스 동기화" target="_blank" rel="noopener"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://presto95.github.io/2020/01/18/%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C-%EA%B0%95%EC%9D%98%EB%85%B8%ED%8A%B8-%EC%A0%95%EB%A6%AC-%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4-%EB%8F%99%EA%B8%B0%ED%99%94/&name=운영체제 강의노트 정리 - 프로세스 동기화&description=" target="_blank" rel="noopener"><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://news.ycombinator.com/submitlink?u=http://presto95.github.io/2020/01/18/%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C-%EA%B0%95%EC%9D%98%EB%85%B8%ED%8A%B8-%EC%A0%95%EB%A6%AC-%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4-%EB%8F%99%EA%B8%B0%ED%99%94/&t=운영체제 강의노트 정리 - 프로세스 동기화" target="_blank" rel="noopener"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#프로세스-동기화"><span class="toc-number">1.</span> <span class="toc-text">프로세스 동기화</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#배경"><span class="toc-number">1.1.</span> <span class="toc-text">배경</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#임계-구역-문제"><span class="toc-number">1.2.</span> <span class="toc-text">임계 구역 문제</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#소프트웨어-접근-방법"><span class="toc-number">1.3.</span> <span class="toc-text">소프트웨어 접근 방법</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#두-개의-프로세스를-위한-해결책"><span class="toc-number">1.3.1.</span> <span class="toc-text">두 개의 프로세스를 위한 해결책</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#첫-번째"><span class="toc-number">1.3.1.1.</span> <span class="toc-text">첫 번째</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#두-번째"><span class="toc-number">1.3.1.2.</span> <span class="toc-text">두 번째</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#세-번째"><span class="toc-number">1.3.1.3.</span> <span class="toc-text">세 번째</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#네-번째"><span class="toc-number">1.3.2.</span> <span class="toc-text">네 번째</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#다중-프로세스를-위한-해결책"><span class="toc-number">1.3.3.</span> <span class="toc-text">다중 프로세스를 위한 해결책</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#동기화-하드웨어"><span class="toc-number">1.4.</span> <span class="toc-text">동기화 하드웨어</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#TestAndSet-명령어"><span class="toc-number">1.4.0.1.</span> <span class="toc-text">TestAndSet 명령어</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Swap-명령어"><span class="toc-number">1.4.0.2.</span> <span class="toc-text">Swap 명령어</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#세마포어"><span class="toc-number">1.5.</span> <span class="toc-text">세마포어</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#사용법"><span class="toc-number">1.5.1.</span> <span class="toc-text">사용법</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#구현"><span class="toc-number">1.5.2.</span> <span class="toc-text">구현</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#이진-세마포어"><span class="toc-number">1.5.3.</span> <span class="toc-text">이진 세마포어</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#고전-동기화-문제"><span class="toc-number">1.6.</span> <span class="toc-text">고전 동기화 문제</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#한계-버퍼-생산자와-소비자-문제"><span class="toc-number">1.6.1.</span> <span class="toc-text">한계 버퍼 생산자와 소비자 문제</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#읽기-쓰기-문제"><span class="toc-number">1.6.2.</span> <span class="toc-text">읽기 쓰기 문제</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#읽기-우선-읽기-쓰기-문제"><span class="toc-number">1.6.2.1.</span> <span class="toc-text">읽기 우선 읽기 쓰기 문제</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#쓰기-우선-읽기-쓰기-문제"><span class="toc-number">1.6.2.2.</span> <span class="toc-text">쓰기 우선 읽기 쓰기 문제</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#철학자들의-만찬-문제"><span class="toc-number">1.7.</span> <span class="toc-text">철학자들의 만찬 문제</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#임계-영역"><span class="toc-number">1.8.</span> <span class="toc-text">임계 영역</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#모니터"><span class="toc-number">1.9.</span> <span class="toc-text">모니터</span></a></li></ol></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        운영체제 강의노트 정리 - 프로세스 동기화
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">Presto</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2020-01-17T15:22:49.000Z" itemprop="datePublished">2020-01-18</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fas fa-archive"></i>
        <a class="category-link" href="/categories/Operating-System/">Operating System</a>
    </div>


      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link" href="/tags/operating-system/" rel="tag">operating system</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h1 id="프로세스-동기화"><a href="#프로세스-동기화" class="headerlink" title="프로세스 동기화"></a>프로세스 동기화</h1><h2 id="배경"><a href="#배경" class="headerlink" title="배경"></a>배경</h2><p>생산자 소비자 문제에서 각 프로세스는 공유 메모리에 접근하므로 공통 변수와 버퍼를 공유한다. 이 때 공유 변수의 값이 결과에 영향을 주므로 각 프로세스에서의 수행이 병행적으로 이루어지면 실행되는 순서에 따라 올바르게 동작하지 않을 수 있다.</p>
<p>이처럼 병행으로 수행되는 여러 프로세스가 공통된 데이터를 조작할 때 결과가 접근 순서에 의해 결정되면, <strong>경합 상태<em>race condition</em></strong>가 존재한다고 말한다.</p>
<p>어떠한 코드 문장이 원자적으로 수행되어도 원하지 않는 결과가 발생할 수 있다.</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">// P1 : a = a + 1; b = b + 1;</span></span><br><span class="line"><span class="comment">// P2 : b = b * 2; a = a * 2;</span></span><br><span class="line">a = a + <span class="number">1</span>;  <span class="comment">// P1</span></span><br><span class="line">b = b * <span class="number">2</span>;  <span class="comment">// P2</span></span><br><span class="line">b = b + <span class="number">1</span>;  <span class="comment">// P1</span></span><br><span class="line">a = a * <span class="number">2</span>;  <span class="comment">// P2</span></span><br></pre></td></tr></table></figure>

<p>위의 코드에서 변수 a와 b의 값이 같을 것을 예상하였으나 기대한 결과가 나오지 않는다.</p>
<p><strong>프로세스 동기화</strong>를 통해 이러한 문제를 해결한다.</p>
<h2 id="임계-구역-문제"><a href="#임계-구역-문제" class="headerlink" title="임계 구역 문제"></a>임계 구역 문제</h2><p><strong>Critical Section</strong></p>
<p>프로세스 코드의 일부분. 다른 프로세스와 공동으로 사용하는 변수, 테이블, 파일 등을 변경하는 부분을 말한다.</p>
<p>임계 구역의 실행은 상호 배타적으로 일어나야 한다. 즉 한 프로세스가 임계 구역을 실행하고 있다면 다른 프로세스는 임계 구역에 진입할 수 없어야 한다.</p>
<p>이를 위해 각 프로세스는 임계 구역에 진입하기 전 허가를 받아야 하며, 이를 <strong>진입 구역<em>entry section</em></strong>이라고 한다.</p>
<p>허가를 받아 임계 구역을 실행한 후 다른 프로세스들이 진입할 수 있도록 해야 하며, 이러한 처리를 하기 위한 구역을 <strong>출구 구역<em>exit section</em></strong>이라고 한다.</p>
<p>진입 구역, 임계 구역, 출구 구역이 아닌 코드 부분을 <strong>잔류 구역<em>remainder section</em></strong>이라고 한다.</p>
<blockquote>
<p>remainder -&gt; <strong>entry -&gt; critical -&gt; exit</strong> -&gt; remainder</p>
</blockquote>
<p>임계 구역 문제를 해결하는 메커니즘은 다음의 요건을 충족해야 한다.</p>
<ul>
<li>상호 배제<em>mutual exclusive</em><ul>
<li>한 프로세스가 임계 구역에서 실행하고 있으면 다른 어떠한 프로세스도 임계 구역에 진입해서는 안된다.</li>
</ul>
</li>
<li>진행<em>progress</em><ul>
<li>여러 개의 프로세스가 임계 구역에 진입하고자 하면 이들의 진입 순서는 이들에 의해 결정되어야 하며, 이 선택은 무한정 연기되어서는 안 된다.</li>
</ul>
</li>
<li>한계 대기<em>bounded waiting</em><ul>
<li>한 프로세스가 임계 구역에 진입하고자 요청한 이후 해당 요청에 허용될 때까지, 다른 프로세스가 임계 구역에 진입할 수 있는 횟수가 제한되어야 한다.</li>
</ul>
</li>
</ul>
<h2 id="소프트웨어-접근-방법"><a href="#소프트웨어-접근-방법" class="headerlink" title="소프트웨어 접근 방법"></a>소프트웨어 접근 방법</h2><h3 id="두-개의-프로세스를-위한-해결책"><a href="#두-개의-프로세스를-위한-해결책" class="headerlink" title="두 개의 프로세스를 위한 해결책"></a>두 개의 프로세스를 위한 해결책</h3><h4 id="첫-번째"><a href="#첫-번째" class="headerlink" title="첫 번째"></a>첫 번째</h4><ul>
<li>공유 변수 <code>int turn</code></li>
<li>초기 값 <code>turn = 1 or 0</code></li>
<li><code>turn</code>이 <code>i</code>이면 <code>P</code><sub><code>i</code></sub>가 임계 지역에 진입할 수 있다.</li>
</ul>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">do</span> &#123;</span><br><span class="line">  <span class="comment">// entry section</span></span><br><span class="line">  <span class="keyword">while</span>(<span class="built_in">turn</span> != i);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// critical section</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// exit section</span></span><br><span class="line">  <span class="built_in">turn</span> = j;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// remainder section</span></span><br><span class="line">&#125; <span class="keyword">while</span>(<span class="number">1</span>);</span><br></pre></td></tr></table></figure>

<p>이 경우 상호 배제는 만족하지만 진행 요구 조건은 충족하지 않는다. 다른 프로세스가 진입하고자 하더라도 해당 프로세스의 차례가 아니면 무조건 기다려야 하기 때문이다.</p>
<p>특히 한 프로세스가 예기치 임계 구역을 실행하던 도중 예기치 않게 종료되면 다른 프로세스는 임계 구역에 영원히 진입할 수 없게 된다.</p>
<h4 id="두-번째"><a href="#두-번째" class="headerlink" title="두 번째"></a>두 번째</h4><ul>
<li>공유 변수 <code>boolean flag[2]</code></li>
<li>초기 값 <code>flag[0] = flag[1] = false</code></li>
<li><code>flag[i]</code>가 <code>true</code>이면 <code>P</code><sub><code>i</code></sub>가 임계 구역에 진입할 준비가 되었음을 나타낸다.</li>
</ul>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">do</span> &#123;</span><br><span class="line">  <span class="comment">// entry section</span></span><br><span class="line">  flag[i] = <span class="literal">true</span>; <span class="comment">// (1)</span></span><br><span class="line">  <span class="keyword">while</span>(flag[j]); <span class="comment">// (2)</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// critical section</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// exit section</span></span><br><span class="line">  flag[i] = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// remainder section</span></span><br><span class="line">&#125; <span class="keyword">while</span>(<span class="number">1</span>);</span><br></pre></td></tr></table></figure>

<p>이 경우 상호 배제는 만족하지만 진행 요구 조건은 충족하지 않는다. 다른 프로세스가 진입하고자 하더라도 해당 프로세스의 차례가 아니면 무조건 기다려야 하기 때문이다.</p>
<p>특히 <code>flag</code> 모두 <code>true</code>가 된 경우 두 프로세스는 영원히 기다리게 된다.</p>
<p>또한 프로세스가 자신의 <code>flag</code> 값을 <code>true</code>로 설정한 후 예기치 않게 종료되면 다른 프로세스는 영원히 진입할 수 없게 된다.</p>
<p>코드에서 (1)과 (2)의 순서를 바꾸면 상호 배제를 만족시키지 않게 된다.</p>
<h4 id="세-번째"><a href="#세-번째" class="headerlink" title="세 번째"></a>세 번째</h4><ul>
<li>공유 변수 <code>boolean flag[2]</code>, <code>int turn</code></li>
<li>초기 값 <code>flag[0] = flag[1] = false</code>, <code>turn = 0 or 1</code></li>
</ul>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">do</span> &#123;</span><br><span class="line">  <span class="comment">// entry section</span></span><br><span class="line">  flag[i] = <span class="literal">true</span>;</span><br><span class="line">  <span class="keyword">while</span>(flag[j]) &#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">turn</span> == j) &#123;</span><br><span class="line">      flag[i] = <span class="literal">false</span>;</span><br><span class="line">      <span class="keyword">while</span>(<span class="built_in">turn</span> == j);</span><br><span class="line">      flag[i] = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// critical section</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// exit section</span></span><br><span class="line">  <span class="built_in">turn</span> = j;</span><br><span class="line">  flag[i] = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// remainder section</span></span><br><span class="line">&#125; whlie(<span class="number">1</span>);</span><br></pre></td></tr></table></figure>

<p>두 프로세스 모두 진입하고자 하는 경우(<code>flag[0] = flag[1] = true</code>) <code>turn</code> 값이 진입하는 프로세스를 결정하게 해주므로 세 가지 요구 조건을 모두 충족하게 된다.</p>
<h3 id="네-번째"><a href="#네-번째" class="headerlink" title="네 번째"></a>네 번째</h3><ul>
<li>공유 변수 <code>boolean flag[2]</code>, <code>int turn</code></li>
<li>초기 값 <code>flag[0] = flag[1] = false</code>, <code>turn = 0 or 1</code></li>
</ul>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">do</span> &#123;</span><br><span class="line">  <span class="comment">// entry section</span></span><br><span class="line">  flag[i] = <span class="literal">true</span>; <span class="comment">// (1)</span></span><br><span class="line">  <span class="built_in">turn</span> = j;       <span class="comment">// (2)</span></span><br><span class="line">  <span class="keyword">while</span>(flag[j] &amp;&amp; <span class="built_in">turn</span> == j);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// critical section</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// exit section</span></span><br><span class="line">  flag[i] = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// remainder section</span></span><br><span class="line">&#125; <span class="keyword">while</span>(<span class="number">1</span>);</span><br></pre></td></tr></table></figure>

<p>(1)에 따라 두 프로세스가 모두 진입하고자 하더라도 <code>turn</code> 변수값에 의해 하나의 프로세스만 <code>while</code>문을 통과할 수 있게 된다. 따라서 상호 배제를 만족하게 된다.</p>
<p><code>while</code>문의 조건에 따라 한 프로세스에 오류가 있더라도 다른 프로세스는 임계 구역에 진입할 수 있다. 따라서 진행 및 한계 대기를 만족하게 된다.</p>
<h3 id="다중-프로세스를-위한-해결책"><a href="#다중-프로세스를-위한-해결책" class="headerlink" title="다중 프로세스를 위한 해결책"></a>다중 프로세스를 위한 해결책</h3><ul>
<li>공유 변수 <code>boolean choosing[n]</code>, <code>int num[n]</code></li>
<li>초기 값 <code>choosing[n] = false</code>, <code>num[n] = 0</code></li>
</ul>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">do</span> &#123;</span><br><span class="line">  <span class="comment">// entry section</span></span><br><span class="line">  choosing[i] = <span class="literal">true</span>;</span><br><span class="line">  num[i] = <span class="built_in">max</span>(num[<span class="number">0</span>] + ... + num[n - <span class="number">1</span>]) + <span class="number">1</span>;</span><br><span class="line">  choosing[i] = <span class="literal">false</span>;</span><br><span class="line">  <span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; n; ++j) &#123;</span><br><span class="line">    <span class="keyword">while</span>(choosing[j]);</span><br><span class="line">    <span class="keyword">while</span>((num[j] != <span class="number">0</span>) &amp;&amp; ((num[j], j) &lt; (num[i], i)));</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// critical section</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// exit section</span></span><br><span class="line">  num[i] = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// remainder section</span></span><br><span class="line">&#125; whlie(<span class="number">1</span>);</span><br></pre></td></tr></table></figure>

<h2 id="동기화-하드웨어"><a href="#동기화-하드웨어" class="headerlink" title="동기화 하드웨어"></a>동기화 하드웨어</h2><p>단일 프로세서 시스템의 경우 공유된 변수를 변경하는 동안 인터럽트를 발생시킬 수 없도록 하여 위와 같은 문제를 쉽게 해결할 수 있다.</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">do</span> &#123;</span><br><span class="line">  <span class="comment">// disable interrupt</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// critical section</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// enable interrupt</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// remainder section</span></span><br><span class="line">&#125; <span class="keyword">while</span>(<span class="number">1</span>);</span><br></pre></td></tr></table></figure>

<p>다중 프로세서 시스템에서는 인터럽트를 발생시키지 못하게 하더라도 여전히 두 프로세서에서 두 프로세스를 동시에 실행할 수 있으므로 임계 구역 문제를 해결할 수 없다.</p>
<p>대부분의 시스템은 특수한 하드웨어 명령어를 사용하여 이와 같은 문제를 해결한다.</p>
<h4 id="TestAndSet-명령어"><a href="#TestAndSet-명령어" class="headerlink" title="TestAndSet 명령어"></a>TestAndSet 명령어</h4><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">boolean</span> <span class="title">TestAndSet</span><span class="params">(<span class="keyword">boolean</span> &amp;target)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">boolean</span> rv = target;</span><br><span class="line">  target = <span class="literal">true</span>;</span><br><span class="line">  <span class="keyword">return</span> rv;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">do</span> &#123;</span><br><span class="line">  <span class="comment">// entry section</span></span><br><span class="line">  <span class="keyword">while</span>(TestAndSet(lock));</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// critical section</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// exit section</span></span><br><span class="line">  lock = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// remainder section</span></span><br><span class="line">&#125; <span class="keyword">while</span>(<span class="number">1</span>);</span><br></pre></td></tr></table></figure>

<h4 id="Swap-명령어"><a href="#Swap-명령어" class="headerlink" title="Swap 명령어"></a>Swap 명령어</h4><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Swap</span><span class="params">(<span class="keyword">boolean</span> &amp;a, <span class="keyword">boolean</span> &amp;b)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">boolean</span> temp = a;</span><br><span class="line">  a = b;</span><br><span class="line">  b = temp;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">do</span> &#123;</span><br><span class="line">  <span class="comment">// entry section</span></span><br><span class="line">  key = <span class="literal">true</span>;</span><br><span class="line">  <span class="keyword">while</span>(key == <span class="literal">true</span>) Swap(lock, key);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// critical section</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// exit section</span></span><br><span class="line">  lock = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// remainder section</span></span><br><span class="line">&#125; <span class="keyword">while</span>(<span class="number">1</span>);</span><br></pre></td></tr></table></figure>

<p>TestAndSet과 Swap 알고리즘은 모두 상호 배제만을 충족할 뿐 한계 대기는 충족시키지 못한다.</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">do</span> &#123;</span><br><span class="line">  <span class="comment">// entry section</span></span><br><span class="line">  waiting[i] = <span class="literal">true</span>;</span><br><span class="line">  key = <span class="literal">true</span>;</span><br><span class="line">  <span class="keyword">while</span>(waiting[i] &amp;&amp; key)</span><br><span class="line">    key = TestAndSet(lock);</span><br><span class="line">  waiting[i] = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// critical section</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// exit section</span></span><br><span class="line">  j = (i + <span class="number">1</span>) % n;</span><br><span class="line">  <span class="keyword">while</span>((j != i) &amp;&amp; !waiting[j])</span><br><span class="line">    j = (j + <span class="number">1</span>) % n;</span><br><span class="line">  <span class="keyword">if</span>(j == i) lock = <span class="literal">false</span>;</span><br><span class="line">  <span class="keyword">else</span> waiting[j] = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// remainder section</span></span><br><span class="line">&#125; <span class="keyword">while</span>(<span class="number">1</span>);</span><br></pre></td></tr></table></figure>

<p>위의 알고리즘을 사용하여 임계 구역 문제의 모든 요구 사항을 충족시킬 수 있다.</p>
<p>동기화 하드웨어나 소프트웨어 접근 방식으로 임계 구역 문제를 해결하려는 경우, 어느 한 프로세스가 임계 구역에 있으면 진입하고자 하는 다른 프로세스는 busy waiting을 해야 한다. 이는 아무 일도 하지 않지만 자원을 계속해서 사용하고 있음을 나타낸다.</p>
<h2 id="세마포어"><a href="#세마포어" class="headerlink" title="세마포어"></a>세마포어</h2><p>Semaphore. 정수 변수이며, 두 가지 연산 <code>wait</code>와 <code>signal</code>을 통해서만 접근할 수 있다. 이 두 연산은 원자적이다.</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">wait(S) &#123;</span><br><span class="line">  <span class="keyword">while</span> (S &lt;= <span class="number">0</span>);</span><br><span class="line">  S--;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">singal(S) &#123;</span><br><span class="line">  S++;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="사용법"><a href="#사용법" class="headerlink" title="사용법"></a>사용법</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">do</span> &#123;</span><br><span class="line">  <span class="comment">// entry section</span></span><br><span class="line">  wait(mutex);</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// critical section</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// exit section</span></span><br><span class="line">  signal(mutex);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// remainder section</span></span><br><span class="line">&#125; <span class="keyword">while</span>(<span class="number">1</span>);</span><br></pre></td></tr></table></figure>

<p>모든 프로세스는 <code>mutex</code>라는 세마포어를 공유하며, 1로 초기화된다.</p>
<p>한계 대기는 충족하지 못한다.</p>
<h3 id="구현"><a href="#구현" class="headerlink" title="구현"></a>구현</h3><p>busy waiting을 하는 세마포어를 <strong>spinlock</strong>이라고 한다. 이는 문맥 전환을 필요로 하지 않아 오랜 시간 동안 busy waiting을 하지 않는다면 효과적인 방법이다.</p>
<p>busy waiting을 제거하기 위해서는 <code>wait</code> 연산을 수행하였을 때 세마포어 값이 양수가 아니면 스스로를 블록하도록 해야 한다.</p>
<p>아래는 busy waiting이 없는 semaphore, <code>wait</code>, <code>signal</code>의 구조다.</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">  <span class="keyword">int</span> value;</span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">process</span> *<span class="title">L</span>;</span></span><br><span class="line">&#125; semaphore;</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">wait</span><span class="params">(semaphore S)</span> </span>&#123;</span><br><span class="line">  S.value--;</span><br><span class="line">  <span class="keyword">if</span>(S.value &lt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="comment">// S.L에 해당 프로세스 추가</span></span><br><span class="line">    block();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">signal</span><span class="params">(semaphore S)</span> </span>&#123;</span><br><span class="line">  S.value++;</span><br><span class="line">  <span class="keyword">if</span>(S.value &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="comment">// S.L에서 해당 프로세스 제거</span></span><br><span class="line">    wakeup(S.L);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>busy waiting이 없는 경우 세마포어는 음수의 값을 가질 수 있으며, 이는 세마포어를 기다리는 프로세스의 수를 나타낸다.</p>
<h3 id="이진-세마포어"><a href="#이진-세마포어" class="headerlink" title="이진 세마포어"></a>이진 세마포어</h3><p>이진 세마포어의 경우 가질 수 있는 값의 범위가 0 또는 1로 제한된다.</p>
<p>아래는 busy waiting이 없는 <code>wait</code>, <code>signal</code>의 구조다.</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">wait</span><span class="params">(semaphore S)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(S.value == <span class="number">1</span>)</span><br><span class="line">    S.value = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// S.L에 해당 프로세스 추가</span></span><br><span class="line">    block();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">signal</span><span class="params">(semaphore S)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(S.L is empty)</span><br><span class="line">    S.value = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// 해당 프로세스를 S.L에서 제거</span></span><br><span class="line">    <span class="comment">// wakeup(S.L);</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="고전-동기화-문제"><a href="#고전-동기화-문제" class="headerlink" title="고전 동기화 문제"></a>고전 동기화 문제</h2><h3 id="한계-버퍼-생산자와-소비자-문제"><a href="#한계-버퍼-생산자와-소비자-문제" class="headerlink" title="한계 버퍼 생산자와 소비자 문제"></a>한계 버퍼 생산자와 소비자 문제</h3><p>생산자는 버퍼가 가득 차 있으면 대기해야 하고, 소비자는 버퍼가 비어 있으면 대기해야 한다.</p>
<p>버퍼에 대한 접근은 상호 배타적이어야 한다.</p>
<p>두 개의 계수 세마포어 <code>empty</code> 및 <code>full</code>과, 한 개의 이진 세마포어 <code>mutex</code>가 사용된다.</p>
<p><code>mutex</code> 세마포어는 상호 배제를 위해, <code>empty</code> 및 <code>full</code> 세마포어는 프로세스 동기화를 위해 사용된다.</p>
<ul>
<li><code>mutex</code> 세마포어는 1로 초기화되며, 버퍼 접근에 대한 상호 배제를 제공한다.</li>
<li><code>empty</code> 세마포어는 버퍼의 크기 n으로 초기화되며, 비어 있는 버퍼의 수를 나타낸다.</li>
<li><code>full</code> 세마포어는 0으로 초기화되며, 채워져 있는 버퍼의 수를 나타낸다.</li>
</ul>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 생산자</span></span><br><span class="line"><span class="keyword">do</span> &#123;</span><br><span class="line">  <span class="comment">// nextp에 다음 item 생산</span></span><br><span class="line"></span><br><span class="line">  wait(empty);</span><br><span class="line">  wait(mutex);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// nextp를 버퍼에 추가</span></span><br><span class="line"></span><br><span class="line">  signal(mutex);</span><br><span class="line">  signal(full);</span><br><span class="line">&#125; <span class="keyword">while</span>(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 소비자</span></span><br><span class="line"><span class="keyword">do</span> &#123;</span><br><span class="line">  wait(full);</span><br><span class="line">  wait(mutex);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 버퍼에 있는 item을 nextc로 옮김</span></span><br><span class="line"></span><br><span class="line">  signal(mutex):</span><br><span class="line">  signal(empty);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// nextc 소비</span></span><br><span class="line">&#125; <span class="keyword">while</span>(<span class="number">1</span>);</span><br></pre></td></tr></table></figure>

<h3 id="읽기-쓰기-문제"><a href="#읽기-쓰기-문제" class="headerlink" title="읽기 쓰기 문제"></a>읽기 쓰기 문제</h3><p>여러 프로세스가 데이터 객체를 공유하는데, 어떠한 프로세스는 이 객체의 내용을 읽고 싶고, 다른 어떠한 프로세스는 이 객체의 내용을 갱신하고 싶다.</p>
<p>하나의 쓰기 프로세스와 다른 프로세스가 병행으로 수행되는 경우 기대하지 않은 결과가 발생할 수 있다.</p>
<h4 id="읽기-우선-읽기-쓰기-문제"><a href="#읽기-우선-읽기-쓰기-문제" class="headerlink" title="읽기 우선 읽기 쓰기 문제"></a>읽기 우선 읽기 쓰기 문제</h4><p>읽기 프로세스는 쓰기 프로세스가 공유 객체에 접근하고 있지 않다면 대기하지 않는다.</p>
<p>쓰기 프로세스가 굶주릴 수 있다.</p>
<h4 id="쓰기-우선-읽기-쓰기-문제"><a href="#쓰기-우선-읽기-쓰기-문제" class="headerlink" title="쓰기 우선 읽기 쓰기 문제"></a>쓰기 우선 읽기 쓰기 문제</h4><p>쓰기 프로세스가 준비되었다면 더이상 새로운 읽기 프로세스를 수행시킬 수 없다.</p>
<p>읽기 프로세스가 굶주릴 수 있다.</p>
<h2 id="철학자들의-만찬-문제"><a href="#철학자들의-만찬-문제" class="headerlink" title="철학자들의 만찬 문제"></a>철학자들의 만찬 문제</h2><p>다섯 명의 철학자 / 철학자는 생각하거나 식사함 / 다섯 개의 젓가락 / 두 개의 젓가락을 집어야 식사 가능</p>
<ol>
<li>세마포어를 하나 사용<ul>
<li>상호 배제는 충족하나, 교착상태 발생 가능성</li>
</ul>
</li>
<li>하나의 젓가락을 집은 다음, 다른 하나를 집을 수 없으면 집은 젓가락을 내려놓고 잠시 기다린 후 다시 시도<ul>
<li>livelock 발생 가능성</li>
<li>임의의 시간을 기다리는 것으로 해결</li>
</ul>
</li>
<li>세마포어를 하나 더 사용하여 전체 과정을 임계 구역으로 설정<ul>
<li>한 번에 한 철학자만 식사 가능</li>
</ul>
</li>
<li>세마포어를 하나 더 사용하여 젓가락을 집는 부분만 임계 구역으로 설정<ul>
<li>교착 상태 발생 가능성</li>
</ul>
</li>
</ol>
<h2 id="임계-영역"><a href="#임계-영역" class="headerlink" title="임계 영역"></a>임계 영역</h2><p>세마포어를 사용하면 상호 배제를 쉽게 충족시킬 수 있으나, 프로그램을 잘못 작성하거나 악용될 위험이 있다.</p>
<p>이러한 문제를 해결하기 위해 세마포어의 상위 개념의 동기화 해결 도구를 사용한다.</p>
<p><strong>임계 영역<em>critical section</em></strong>과 <strong>모니터<em>monitor</em></strong>가 있다.</p>
<ul>
<li>공유 변수 <code>v: shared T</code></li>
<li><code>region v when (B) S;</code> : B 조건이 참일 때 S 문장을 수행할 수 있음, 이미 한 프로세스가 S를 수행하고 있으면 다른 프로세스는 기다림</li>
</ul>
<p>병행 수행되더라도 원자적으로 수행된다.</p>
<h2 id="모니터"><a href="#모니터" class="headerlink" title="모니터"></a>모니터</h2><p>모니터 내에 선언된 변수는 모니터 내에 정의된 함수를 통해서만 접근 가능하며, 모니터 내에 정의된 함수는 모니터 내에 정의된 변수만 사용할 수 있다.</p>
<p>한번에 한 프로세스만이 모니터 내부 함수를 실행할 수 있다.</p>
<p>모니터 내에 정의된 함수를 사용할 수 없을 때 대기할 수 있도록 하기 위해 추가로 조건<em>condition</em> 타입의 변수를 제공한다.</p>
<p>조건 변수는 다음의 두 연산에 의해서만 조작될 수 있다.</p>
<ul>
<li><code>wait</code> : 이 연산을 수행하는 프로세스는 대기한다.</li>
<li><code>signal</code> : 이 연산을 수행하면 대기 중인 하나의 프로세스가 재개한다.</li>
</ul>

  </div>
</article>

    <div class="blog-post-comments">
        <div id="disqus_thread">
            <noscript>Please enable JavaScript to view the comments.</noscript>
        </div>
    </div>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Posts</a></li>
         
          <li><a href="/tags/">Tag</a></li>
         
          <li><a href="/categories/">Category</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#프로세스-동기화"><span class="toc-number">1.</span> <span class="toc-text">프로세스 동기화</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#배경"><span class="toc-number">1.1.</span> <span class="toc-text">배경</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#임계-구역-문제"><span class="toc-number">1.2.</span> <span class="toc-text">임계 구역 문제</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#소프트웨어-접근-방법"><span class="toc-number">1.3.</span> <span class="toc-text">소프트웨어 접근 방법</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#두-개의-프로세스를-위한-해결책"><span class="toc-number">1.3.1.</span> <span class="toc-text">두 개의 프로세스를 위한 해결책</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#첫-번째"><span class="toc-number">1.3.1.1.</span> <span class="toc-text">첫 번째</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#두-번째"><span class="toc-number">1.3.1.2.</span> <span class="toc-text">두 번째</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#세-번째"><span class="toc-number">1.3.1.3.</span> <span class="toc-text">세 번째</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#네-번째"><span class="toc-number">1.3.2.</span> <span class="toc-text">네 번째</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#다중-프로세스를-위한-해결책"><span class="toc-number">1.3.3.</span> <span class="toc-text">다중 프로세스를 위한 해결책</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#동기화-하드웨어"><span class="toc-number">1.4.</span> <span class="toc-text">동기화 하드웨어</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#TestAndSet-명령어"><span class="toc-number">1.4.0.1.</span> <span class="toc-text">TestAndSet 명령어</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Swap-명령어"><span class="toc-number">1.4.0.2.</span> <span class="toc-text">Swap 명령어</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#세마포어"><span class="toc-number">1.5.</span> <span class="toc-text">세마포어</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#사용법"><span class="toc-number">1.5.1.</span> <span class="toc-text">사용법</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#구현"><span class="toc-number">1.5.2.</span> <span class="toc-text">구현</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#이진-세마포어"><span class="toc-number">1.5.3.</span> <span class="toc-text">이진 세마포어</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#고전-동기화-문제"><span class="toc-number">1.6.</span> <span class="toc-text">고전 동기화 문제</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#한계-버퍼-생산자와-소비자-문제"><span class="toc-number">1.6.1.</span> <span class="toc-text">한계 버퍼 생산자와 소비자 문제</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#읽기-쓰기-문제"><span class="toc-number">1.6.2.</span> <span class="toc-text">읽기 쓰기 문제</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#읽기-우선-읽기-쓰기-문제"><span class="toc-number">1.6.2.1.</span> <span class="toc-text">읽기 우선 읽기 쓰기 문제</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#쓰기-우선-읽기-쓰기-문제"><span class="toc-number">1.6.2.2.</span> <span class="toc-text">쓰기 우선 읽기 쓰기 문제</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#철학자들의-만찬-문제"><span class="toc-number">1.7.</span> <span class="toc-text">철학자들의 만찬 문제</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#임계-영역"><span class="toc-number">1.8.</span> <span class="toc-text">임계 영역</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#모니터"><span class="toc-number">1.9.</span> <span class="toc-text">모니터</span></a></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://presto95.github.io/2020/01/18/%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C-%EA%B0%95%EC%9D%98%EB%85%B8%ED%8A%B8-%EC%A0%95%EB%A6%AC-%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4-%EB%8F%99%EA%B8%B0%ED%99%94/" target="_blank" rel="noopener"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://presto95.github.io/2020/01/18/%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C-%EA%B0%95%EC%9D%98%EB%85%B8%ED%8A%B8-%EC%A0%95%EB%A6%AC-%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4-%EB%8F%99%EA%B8%B0%ED%99%94/&text=운영체제 강의노트 정리 - 프로세스 동기화" target="_blank" rel="noopener"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://presto95.github.io/2020/01/18/%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C-%EA%B0%95%EC%9D%98%EB%85%B8%ED%8A%B8-%EC%A0%95%EB%A6%AC-%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4-%EB%8F%99%EA%B8%B0%ED%99%94/&title=운영체제 강의노트 정리 - 프로세스 동기화" target="_blank" rel="noopener"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://presto95.github.io/2020/01/18/%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C-%EA%B0%95%EC%9D%98%EB%85%B8%ED%8A%B8-%EC%A0%95%EB%A6%AC-%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4-%EB%8F%99%EA%B8%B0%ED%99%94/&is_video=false&description=운영체제 강의노트 정리 - 프로세스 동기화" target="_blank" rel="noopener"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=운영체제 강의노트 정리 - 프로세스 동기화&body=Check out this article: http://presto95.github.io/2020/01/18/%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C-%EA%B0%95%EC%9D%98%EB%85%B8%ED%8A%B8-%EC%A0%95%EB%A6%AC-%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4-%EB%8F%99%EA%B8%B0%ED%99%94/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://presto95.github.io/2020/01/18/%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C-%EA%B0%95%EC%9D%98%EB%85%B8%ED%8A%B8-%EC%A0%95%EB%A6%AC-%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4-%EB%8F%99%EA%B8%B0%ED%99%94/&title=운영체제 강의노트 정리 - 프로세스 동기화" target="_blank" rel="noopener"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://presto95.github.io/2020/01/18/%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C-%EA%B0%95%EC%9D%98%EB%85%B8%ED%8A%B8-%EC%A0%95%EB%A6%AC-%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4-%EB%8F%99%EA%B8%B0%ED%99%94/&title=운영체제 강의노트 정리 - 프로세스 동기화" target="_blank" rel="noopener"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://presto95.github.io/2020/01/18/%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C-%EA%B0%95%EC%9D%98%EB%85%B8%ED%8A%B8-%EC%A0%95%EB%A6%AC-%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4-%EB%8F%99%EA%B8%B0%ED%99%94/&title=운영체제 강의노트 정리 - 프로세스 동기화" target="_blank" rel="noopener"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://presto95.github.io/2020/01/18/%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C-%EA%B0%95%EC%9D%98%EB%85%B8%ED%8A%B8-%EC%A0%95%EB%A6%AC-%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4-%EB%8F%99%EA%B8%B0%ED%99%94/&title=운영체제 강의노트 정리 - 프로세스 동기화" target="_blank" rel="noopener"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://presto95.github.io/2020/01/18/%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C-%EA%B0%95%EC%9D%98%EB%85%B8%ED%8A%B8-%EC%A0%95%EB%A6%AC-%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4-%EB%8F%99%EA%B8%B0%ED%99%94/&name=운영체제 강의노트 정리 - 프로세스 동기화&description=" target="_blank" rel="noopener"><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://news.ycombinator.com/submitlink?u=http://presto95.github.io/2020/01/18/%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C-%EA%B0%95%EC%9D%98%EB%85%B8%ED%8A%B8-%EC%A0%95%EB%A6%AC-%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4-%EB%8F%99%EA%B8%B0%ED%99%94/&t=운영체제 강의노트 정리 - 프로세스 동기화" target="_blank" rel="noopener"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2020 Presto
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Posts</a></li>
         
          <li><a href="/tags/">Tag</a></li>
         
          <li><a href="/categories/">Category</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->

<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">


<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">


    <!-- jquery -->

<script src="/lib/jquery/jquery.min.js"></script>


<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>

<!-- clipboard -->

  
<script src="/lib/clipboard/clipboard.min.js"></script>

  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Disqus Comments -->

    <script type="text/javascript">
        var disqus_shortname = 'presto95';

        (function(){
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        }());
    </script>


</body>
</html>
